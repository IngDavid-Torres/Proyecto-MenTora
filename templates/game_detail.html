<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>{{ game.name }} | MenTora</title>
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #181c23;
            color: #f4f6f8;
            min-height: 100vh;
        }
        .container {
            max-width: 600px;
            margin: 2.5rem auto;
            background: #23272f;
            border-radius: 14px;
            box-shadow: 0 2px 16px rgba(44,62,80,0.13);
            padding: 2rem 2.5rem;
        }
        h1 {
            color: #ffe066;
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        .desc {
            color: #bfc9d1;
            font-size: 1.1rem;
            margin-bottom: 1.2rem;
        }
        .rules {
            background: #1a1d22;
            color: #ffe066;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        .play-section {
            margin-top: 2rem;
        }
        textarea, input[type="text"] {
            width: 100%;
            padding: 0.7rem;
            border-radius: 8px;
            border: 1px solid #bfc9d1;
            font-size: 1rem;
            margin-bottom: 1rem;
            background: #23272f;
            color: #f4f6f8;
        }
        button {
            background: #ffe066;
            color: #2a5298;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            padding: 0.7rem 2rem;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }
        button:hover {
            background: #fab005;
            color: #fff;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 1.2rem;
            color: #ffe066;
            text-decoration: none;
            font-weight: bold;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .output {
            background: #1a1d22;
            color: #ffe066;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            font-family: 'Fira Mono', monospace;
            font-size: 1.05rem;
        }
    </style>
</head>
<body>
    <!-- Fondo animado de programación -->
    <svg style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:0;pointer-events:none;opacity:0.13;" viewBox="0 0 1920 1080" fill="none" xmlns="http://www.w3.org/2000/svg">
        <!-- Circuitos animados -->
        <g stroke="#ffe066" stroke-width="2">
            <polyline points="200,100 400,100 400,300 600,300"/>
            <polyline points="800,200 1000,200 1000,400 1200,400"/>
            <polyline points="1400,500 1600,500 1600,700 1800,700"/>
            <circle cx="400" cy="100" r="8" fill="#fab005">
                <animate attributeName="r" values="8;14;8" dur="2s" repeatCount="indefinite"/>
            </circle>
            <circle cx="1000" cy="200" r="8" fill="#fab005">
                <animate attributeName="r" values="8;14;8" dur="2.2s" repeatCount="indefinite"/>
            </circle>
            <circle cx="1600" cy="500" r="8" fill="#fab005">
                <animate attributeName="r" values="8;14;8" dur="2.4s" repeatCount="indefinite"/>
            </circle>
        </g>
        <!-- Partículas -->
        <g>
            <circle cx="300" cy="900" r="18" fill="#fff" opacity="0.13">
                <animate attributeName="cy" values="900;200;900" dur="12s" repeatCount="indefinite"/>
            </circle>
            <circle cx="1700" cy="200" r="12" fill="#ffe066" opacity="0.13">
                <animate attributeName="cy" values="200;800;200" dur="10s" repeatCount="indefinite"/>
            </circle>
            <circle cx="800" cy="1000" r="10" fill="#fab005" opacity="0.13">
                <animate attributeName="cy" values="1000;400;1000" dur="14s" repeatCount="indefinite"/>
            </circle>
        </g>
        <!-- Símbolos de programación animados -->
        <g font-family="Fira Mono, monospace" font-size="38" font-weight="bold">
            <text x="200" y="300" fill="#ffe066" opacity="0.18">
                &lt;/&gt;
                <animate attributeName="y" values="300;320;300" dur="4s" repeatCount="indefinite"/>
            </text>
            <text x="1200" y="700" fill="#fab005" opacity="0.18">
                { }
                <animate attributeName="y" values="700;720;700" dur="5s" repeatCount="indefinite"/>
            </text>
            <text x="900" y="200" fill="#fff" opacity="0.18">
                ( )
                <animate attributeName="y" values="200;220;200" dur="3.5s" repeatCount="indefinite"/>
            </text>
            <text x="600" y="500" fill="#ffe066" opacity="0.18">
                if (x &gt; 0):
                <animate attributeName="y" values="500;520;500" dur="6s" repeatCount="indefinite"/>
            </text>
        </g>
    </svg>
    <div class="container" style="position:relative;z-index:1;box-shadow:0 8px 32px rgba(44,62,80,0.18);">
        <a href="/games" class="back-link">← Volver a Juegos</a>
    <h1 style="letter-spacing:1px;text-shadow:0 2px 12px #2a5298;">{{ game.name }}</h1>
    <div class="desc" style="font-size:1.15rem;line-height:1.5;">{{ game.description }}</div>
    <div class="rules" style="background:linear-gradient(90deg,#ffe06622,#fab00522);color:#ffe066;box-shadow:0 2px 12px #2a529833;"><b>Reglas:</b> {{ game.rules }}</div>
    <div class="play-section" style="margin-top:2.5rem;">
            {% if game.name|lower == 'hola mundo' %}
                {% if show_animated_alert %}
                <div id="success-animated-alert" style="display:flex;align-items:center;justify-content:center;gap:1rem;background:#ffe066;color:#2a5298;padding:1.1rem 1.5rem;border-radius:14px;font-weight:bold;margin-bottom:1.2rem;box-shadow:0 2px 16px rgba(44,62,80,0.13);font-size:1.2rem;animation:popIn 0.7s cubic-bezier(.4,2,.3,1);">
                    <svg width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="19" cy="19" r="18" stroke="#2a5298" stroke-width="3" fill="#fffbe6"/>
                        <path d="M11 20.5L17 26L27 14" stroke="#2a5298" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>¡Excelente, así se hace! <b>Subes de nivel</b> (+10% progreso)</span>
                </div>
                <style>
                @keyframes popIn {
                    0% { transform: scale(0.7); opacity: 0; }
                    70% { transform: scale(1.1); opacity: 1; }
                    100% { transform: scale(1); opacity: 1; }
                }
                </style>
                {% elif feedback %}
                    <div style="background:#ffe066;color:#2a5298;padding:0.7rem 1rem;border-radius:8px;font-weight:bold;margin-bottom:1rem;">{{ feedback }}</div>
                {% endif %}
                {% if not cooldown and not success %}
                <form method="POST" action="/games/{{ game.id }}/run" style="margin-bottom:1.5rem;">
                    <label for="code" style="font-weight:bold;">Escribe tu código en Python:</label>
                    <textarea id="code" name="code" rows="6" required placeholder="print('Hola mundo')"></textarea>
                    <button type="submit">Ejecutar Código</button>
                </form>
                {% endif %}
                <div style="margin-bottom:0.7rem;">
                    <span style="color:#ffe066;">Vidas restantes: </span>
                    <span style="color:#fff; font-weight:bold;">{{ max_attempts - (attempts or 0) if not cooldown else 0 }}/{{ max_attempts }}</span>
                </div>
                {% if output is defined and output %}
                <div class="output">
                    <b>Salida:</b><br>
                    {{ output }}
                </div>
                {% endif %}
            {% elif game.name|lower == 'la suma de dos números' %}
                {% if show_animated_alert %}
                <div id="success-animated-alert" style="display:flex;align-items:center;justify-content:center;gap:1rem;background:#ffe066;color:#2a5298;padding:1.1rem 1.5rem;border-radius:14px;font-weight:bold;margin-bottom:1.2rem;box-shadow:0 2px 16px rgba(44,62,80,0.13);font-size:1.2rem;animation:popIn 0.7s cubic-bezier(.4,2,.3,1);">
                    <svg width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="19" cy="19" r="18" stroke="#2a5298" stroke-width="3" fill="#fffbe6"/>
                        <path d="M11 20.5L17 26L27 14" stroke="#2a5298" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>¡Excelente, así se hace! <b>Subes de nivel</b> (+10% progreso)</span>
                </div>
                <style>
                @keyframes popIn {
                    0% { transform: scale(0.7); opacity: 0; }
                    70% { transform: scale(1.1); opacity: 1; }
                    100% { transform: scale(1); opacity: 1; }
                }
                </style>
                {% elif feedback %}
                    <div style="background:#ffe066;color:#2a5298;padding:0.7rem 1rem;border-radius:8px;font-weight:bold;margin-bottom:1rem;">{{ feedback }}</div>
                {% endif %}
                {% if not cooldown and not success %}
                <form method="POST" action="/games/{{ game.id }}/run" style="margin-bottom:1.5rem;">
                    <label for="code" style="font-weight:bold;">Escribe tu código en Python que sume dos números:</label>
                    <textarea id="code" name="code" rows="6" required placeholder="a = 5\nb = 7\nprint(a + b)"></textarea>
                    <button type="submit">Ejecutar Código</button>
                </form>
                {% endif %}
                <div style="margin-bottom:0.7rem;">
                    <span style="color:#ffe066;">Vidas restantes: </span>
                    <span style="color:#fff; font-weight:bold;">{{ max_attempts - (attempts or 0) if not cooldown else 0 }}/{{ max_attempts }}</span>
                </div>
                {% if output is defined and output %}
                <div class="output">
                    <b>Salida:</b><br>
                    {{ output }}
                </div>
                {% endif %}
            {% else %}
                <p>Próximamente podrás jugar/interactuar con este juego.</p>
            {% endif %}
        </div>
    </div>
</body>
</html>
